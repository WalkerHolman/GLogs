-- back compat for old kwarg name
  
  begin;
    
        
            
                
                
            
                
                
            
        
    

    

    merge into snowflake_learning_db.public.fct_weather_hourly as DBT_INTERNAL_DEST
        using snowflake_learning_db.public.fct_weather_hourly__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.location = DBT_INTERNAL_DEST.location
                ) and (
                    DBT_INTERNAL_SOURCE.time_hour = DBT_INTERNAL_DEST.time_hour
                )

    
    when matched then update set
        "LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","TIME_HOUR" = DBT_INTERNAL_SOURCE."TIME_HOUR","DATE" = DBT_INTERNAL_SOURCE."DATE","HOUR_OF_DAY" = DBT_INTERNAL_SOURCE."HOUR_OF_DAY","WEEKDAY_ISO" = DBT_INTERNAL_SOURCE."WEEKDAY_ISO","WEEKDAY_NAME" = DBT_INTERNAL_SOURCE."WEEKDAY_NAME","MONTH_NUM" = DBT_INTERNAL_SOURCE."MONTH_NUM","MONTH_NAME" = DBT_INTERNAL_SOURCE."MONTH_NAME","IS_WEEKEND" = DBT_INTERNAL_SOURCE."IS_WEEKEND","TEMPERATURE_C" = DBT_INTERNAL_SOURCE."TEMPERATURE_C","TEMPERATURE_F" = DBT_INTERNAL_SOURCE."TEMPERATURE_F","PRECIPITATION_PROBABILITY" = DBT_INTERNAL_SOURCE."PRECIPITATION_PROBABILITY","PRECIPITATION_MM" = DBT_INTERNAL_SOURCE."PRECIPITATION_MM","IS_PRECIPITATING" = DBT_INTERNAL_SOURCE."IS_PRECIPITATING","IS_DAY" = DBT_INTERNAL_SOURCE."IS_DAY","DAY_NIGHT" = DBT_INTERNAL_SOURCE."DAY_NIGHT","PRECIPITATION_INTENSITY" = DBT_INTERNAL_SOURCE."PRECIPITATION_INTENSITY","PRECIPITATION_PROB_BUCKET_START" = DBT_INTERNAL_SOURCE."PRECIPITATION_PROB_BUCKET_START"
    

    when not matched then insert
        ("LOCATION", "TIME_HOUR", "DATE", "HOUR_OF_DAY", "WEEKDAY_ISO", "WEEKDAY_NAME", "MONTH_NUM", "MONTH_NAME", "IS_WEEKEND", "TEMPERATURE_C", "TEMPERATURE_F", "PRECIPITATION_PROBABILITY", "PRECIPITATION_MM", "IS_PRECIPITATING", "IS_DAY", "DAY_NIGHT", "PRECIPITATION_INTENSITY", "PRECIPITATION_PROB_BUCKET_START")
    values
        ("LOCATION", "TIME_HOUR", "DATE", "HOUR_OF_DAY", "WEEKDAY_ISO", "WEEKDAY_NAME", "MONTH_NUM", "MONTH_NAME", "IS_WEEKEND", "TEMPERATURE_C", "TEMPERATURE_F", "PRECIPITATION_PROBABILITY", "PRECIPITATION_MM", "IS_PRECIPITATING", "IS_DAY", "DAY_NIGHT", "PRECIPITATION_INTENSITY", "PRECIPITATION_PROB_BUCKET_START")

;
    commit;